var DragonSlayer = DragonSlayer || {};

DragonSlayer.Preload = function () {
	this.ready = false;
};

DragonSlayer.Preload.prototype = {
	preload: function () {
		
		this.preloadBar = this.add.sprite(0, 0, 'preloadBar');
		this.preloadBar.anchor.setTo(0.5);

		this.load.setPreloadSprite(this.preloadBar);
		this.load.bitmapFont('Ruritania', "<%= font_path 'Ruritania/font.png' %>", "<%= font_path 'Ruritania/font.fnt' %>");
		this.load.bitmapFont('Albion', "<%= font_path 'Albion/font.png' %>", "<%= font_path 'Albion/font.fnt' %>");

		this.load.image('Wall', "<%= image_path 'Wall.jpg' %>");
		this.load.image('Grass', "<%= image_path 'grass.png' %>");
		this.load.image('SubmitSword', "<%= image_path 'swordSilver.png' %>");
		
		this.load.spritesheet('Player1', "<%= image_path 'champion.png' %>", 158,152, 100);
		this.load.spritesheet('Player2', "<%= image_path 'Cavalier2.png' %>", 229, 170, 100);
		this.load.spritesheet('BlackKnight', "<%= image_path 'blackknight.png' %>", 129.8, 128.5, 68);
		this.load.spritesheet('Skeleton', "<%= image_path 'Skeleton.png' %>", 176, 153, 100);
		this.load.spritesheet('Potions', "<%= image_path 'alchemy-sprite.png' %>", 48, 48, 35);
		this.load.spritesheet('Rewards', "<%= image_path 'Treasure.png' %>", 64, 37, 32);

		this.load.spritesheet('Skeleton1', "<%= image_path 'Skeleton1.png' %>", 182, 160, 100);
		this.load.spritesheet('Dragon', "<%= image_path 'RedDragon2.png' %>", 264, 186, 100 );

		this.load.audio('SwordClash', ["<%= audio_path 'Swords.mp3' %>", "<%= audio_path 'Swords.ogg' %>"]);
		this.load.audio('gameMusic', ["<%= audio_path 'MedievalMadnessSoundtrack.mp3' %>", "<%= audio_path 'MedievalMadnessSoundtrack.ogg' %>"]);

		this.load.onLoadComplete.add(this.onLoadComplete, this);

	},

	create: function () {
		this.preloadBar.cropEnabled = false;
	},

	update: function () {
		if (this.cache.isSoundDecoded('gameMusic') && this.ready === true) {
			this.state.start('MainMenu');
		}
	},

	onLoadComplete: function () {
		this.ready = true;
	}
};